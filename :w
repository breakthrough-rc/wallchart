use crate::routes;
use crate::state::WebHtmxState;
use axum::{
    extract::{self, State},
    response::IntoResponse,
    routing::{get, put},
    Form, Router,
};
use serde::Deserialize;

pub fn selected_worksite_routes(state: WebHtmxState) -> Router {
    Router::new()
        .route(routes::SELECTED_WORKSITE, put(put_selected_worksite))
        .with_state(state)
}

#[derive(Deserialize, Debug)]
struct SetSelectedWorksiteFormData {
    worksite_id: String,
}

async fn put_selected_worksite(
    State(state): State<WebHtmxState>,
    Form(form): Form<SetSelectedWorksiteFormData>,
) -> impl IntoResponse {
    crate::context::set_worksite_id(form.worksite_id).await;
}
